<extend name="Public:menu"/>
<block name="head">
    <link rel="stylesheet" href="__PUBLIC__/css/plyr.css">
    <link rel="stylesheet" href="__PUBLIC__/plugins/video.js/dist/video-js.min.css">
    <script src="__PUBLIC__/js/plyr.js"></script>
    <script src="__PUBLIC__/plugins/flv.js/dist/flv.min.js"></script>
    <script src="__PUBLIC__/plugins/video.js/dist/video.min.js"></script>
    <script src="http://api.html5media.info/1.1.8/html5media.min.js"></script>
    <style>
        .mainContainer {
            display: block;
            width: 1024px;
            margin-left: auto;
            margin-right: auto;
        }

        .urlInput {
            display: block;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            margin-top: 8px;
            margin-bottom: 8px;
        }

        .centeredVideo {
            display: block;
            /*width: 100%;*/
            /*height: 576px;*/
            margin-left: auto;
            margin-right: auto;
            margin-bottom: auto;
        }

        .controls {
            display: block;
            width: 100%;
            text-align: left;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
    <script>
        document.documentElement.style.fontSize = $(document.documentElement).width() / 7.5 + 'px';
        $(window).on('resize', function() {
            document.documentElement.style.fontSize = $(document.documentElement).width() / 7.5 + 'px';
        });
    </script>
</block>
<block name="content">
    <div class="title">
        <h3>1111111111111111</h3>
        <div class="mainContainer">
            <!--<video id="videoElement" name="videoElement" class="centeredVideo" controls width="200" >-->
                <!--Your browser is too old which doesn't support HTML5 video.-->
            <!--</video>-->
            <div class="videoBox">
                <i class="fa fa-play-circle-o"></i>
                <video id="video" x5-video-player-type="h5" x5-video-player-fullscreen="true" x-webkit-airplay="allow" webkit-playsinline playsinline  poster="video.png" preload="metadata"></video>
                <canvas id="canvas" width="1920" height="1080"></canvas>
            </div>
            <br>
            <div class="controls">
                <button onclick="flv_load()">Load</button>
                <button onclick="flv_start()">Start</button>
                <button onclick="flv_pause()">Pause</button>
                <button onclick="flv_destroy()">Destroy</button>
                <input style="width:100px" type="text" name="seekpoint"/>
                <button onclick="flv_seekto()">SeekTo</button>
            </div>
        </div>
<script>
    function supportMSEH264Playback() {
        return (window.MediaSource || window.WebKitMediaSource) &&
            window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');
    }
    var u = navigator.userAgent;
    var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
    var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
    if(isAndroid){
        $("#video").hide();
        $("i.fa").show();
    }else{
        $("i.fa").hide();
        $("#canvas").hide();
    }
    var videoanimate;
    canvas = document.getElementById('canvas');
    context = canvas.getContext( '2d' );
    context.fillStyle = '#fff';
    context.fillRect( 0, 0, canvas.width, canvas.height );//绘制1920*1080像素的已填充矩形。
    var img=new Image();//新建一个图片，模仿video里面的poster属性。
    img.src="video.png";
    context.drawImage(img,0, 0,canvas.width,canvas.height);//将图片绘制进canvas。
    function animate() {    //渲染方法。
        if(video.paused){     //判断视频是否暂停，如果暂停显示控件。
            $(".video i.fa").show();
        }
        context.drawImage(video,0, 0,canvas.width,canvas.height);//将视频当中的一帧绘制到canvas当中。
        videoanimate = requestAnimationFrame( animate );//每秒60帧渲染页面。关于此方法具体解释请自行百度。
    }
    $("#canvas,i.fa").click(function(){
        if(isAndroid){
            animate();   //在这里调用。
            if(!video.paused){    //判断视频时候暂停。
                video.pause();
            }else{
                video.play();
                $(".video i.fa").hide();
            }
        }
    })
</script>
        <script>
            function flv_load() {
                    var videoElement = document.getElementById('video');
                    var flvPlayer = flvjs.createPlayer({
                        type: 'flv',
                        url: 'http://localhost/IStudy/Public/Upload/video/7.flv'
                    });
                    flvPlayer.attachMediaElement(videoElement);
                    flvPlayer.load();

                window.player=flvPlayer;
            }

            function flv_start() {
                player.play();
            }

            function flv_pause() {
                player.pause();
            }

            function flv_destroy() {
                player.pause();
                player.unload();
                player.detachMediaElement();
                player.destroy();
                player = null;
            }

            function flv_seekto() {
                var input = document.getElementsByName('seekpoint')[0];
                player.currentTime = parseFloat(input.value);
            }

            function getUrlParam(key, defaultValue) {
                var pageUrl = window.location.search.substring(1);
                var pairs = pageUrl.split('&');
                for (var i = 0; i < pairs.length; i++) {
                    var keyAndValue = pairs[i].split('=');
                    if (keyAndValue[0] === key) {
                        return keyAndValue[1];
                    }
                }
                return defaultValue;
            }

        </script>
</block>